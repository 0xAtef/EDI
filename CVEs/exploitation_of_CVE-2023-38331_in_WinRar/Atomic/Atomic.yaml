attack_technique: TA0002
display_name: POC for CVE-2023-38831 in Winrar
atomic_tests:
- name: POC for CVE-2023-38831 in Winrar
  auto_generated_guid: e7b1a2fc-e863-4677-aa91-b608ab25cef6
  description: |
    An exploitable vulnerability has been identified in RARLabs WinRAR versions prior to 6.23. 
    This vulnerability enables attackers to execute arbitrary code through a specifically crafted ZIP archive. 
    The vulnerability arises due to the mishandling of ZIP archives containing benign files, such as ordinary .PDF document, 
    alongside folders sharing the same name. When a user attempts to access the benign file, 
    the archive may include a similarly named folder containing executable content. 
    This malicious content within the folder is processed during the attempt to access the benign file, facilitating the execution of arbitrary code. 

  supported_platforms:
  - windows
  
  input_arguments:
    poc_rar:
      description: a crafted POC rar file 
      type: path
      default: PathToAtomicsFolder\Atomic\src\poc.rar
  
  dependency_executor_name: powershell
  dependencies:
  - description: Make sure Winrar is installed on the system with version prior to 6.23.0
    prereq_command: If([String](Get-Item -Path "$Env:ProgramFiles\WinRAR\WinRAR.exe","${Env:ProgramFiles(x86)}\WinRAR\WinRAR.exe" -ErrorAction SilentlyContinue).VersionInfo.FileVersion -le "6.23.0"){exit 0} else{exit 1}
    get_prereq_command: Write-Host "Please install winrar with a version prior to 6.23.0"
    
  executor:
    command: "#{poc_rar}"
    name: command_prompt
    elevation_required: false