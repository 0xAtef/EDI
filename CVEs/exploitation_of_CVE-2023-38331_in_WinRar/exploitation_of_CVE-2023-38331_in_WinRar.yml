id: 2d395b02-2fb0-43f6-b5a7-a4ec90282d58
title: Exploitation of CVE-2023-38331 in WinRar
status: experimental
description: Detects the exploitation of CVE-2023-38331 in WinRAR. when successfull the attacker tricks the victim into clicking on a benign-looking file, only to execute a different, potentially harmful file.
references:
    - https://github.com/SigmaHQ/sigma/blob/master/rules-emerging-threats/2023/Exploits/CVE-2023-38831/file_event_win_exploit_cve_2023_38331_winrar_susp_double_ext.yml
    - https://github.com/HDCE-inc/CVE-2023-38831
author: Inovasys
date: 2024/2/11
tags:
    - attack.execution
    - cve.2023.38331

logsource:
    category: file_event
    product: windows

detection:
    selection_files_droped:
        Image|endswith: '\WinRAR.exe'
        TargetFilename|contains: '\AppData\Local\Temp\Rar$'
        TargetFilename|re: '\.[a-zA-Z0-9]{1,4} \.'

    condition: selection_files_droped

falsepositives: Unknown
level: high
---

title: Exploitation of CVE-2023-38331 in WinRar
id: cd0ce128-4a05-43a0-9c5f-c1f4bfc97948
status: experimental
description: Detects the exploitation of CVE-2023-38331 in WinRAR. when successfull the attacker tricks the victim into clicking on a benign-looking file, only to execute a different, potentially harmful file.
references:
    - https://github.com/HDCE-inc/CVE-2023-38831

author: Inovasys
date: 2024/2/11
tags:
    - attack.execution
    - cve.2023.38331

logsource:
    category: process_creation
    product: windows

detection:
    selection_parent_winrar:
        ParentImage|endswith: '\WinRAR.exe'

    selection_double_extention:
        CommandLine|contains: '\AppData\Local\Temp\Rar$'
        CommandLine|re: '\.[a-zA-Z0-9]{1,4} \.'

    condition: selection_parent_winrar and selection_double_extention

falsepositives: Unknown
level: high
